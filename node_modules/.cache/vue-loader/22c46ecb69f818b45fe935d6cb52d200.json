{"remainingRequest":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\src\\views\\student\\alter\\alterPassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\src\\views\\student\\alter\\alterPassword.vue","mtime":1618718209885},{"path":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616485460902},{"path":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\node_modules\\babel-loader\\lib\\index.js","mtime":1616485540067},{"path":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616485460902},{"path":"C:\\Users\\xiaoxi\\Desktop\\毕业设计\\Mr.Qin\\DivineChoice\\node_modules\\vue-loader\\lib\\index.js","mtime":1616485526728}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from 'axios';\nimport {\n\tMessage\n} from 'element-ui';\nexport default {\n\tname: 'AlterPassword',\n\tdata() {\n\n\t\tvar checkPassword = (rule, value, callback) => {\n\n\t\t\tif (value === '') {\n\t\t\t\treturn callback(new Error('原密码不能为空'))\n\t\t\t} else if (value !== JSON.parse(this.$store.state.token).password) {\n\t\t\t\treturn callback(new Error('与原密码不一致'))\n\t\t\t}\n\t\t\tcallback()\n\n\t\t}\n\n\t\tvar checkalterPass = (rule, value, callback) => {\n\n\t\t\tif (value === '') {\n\t\t\t\treturn callback(new Error('修改密码不能为空'))\n\t\t\t} else if (this.form.confirmPassword !== '') {\n\t\t\t\tif (value !== this.form.confirmPassword) {\n\t\t\t\t\treturn callback(new Error('两次密码不一致'))\n\t\t\t\t}\n\t\t\t}\n\t\t\tcallback()\n\n\t\t}\n\n\t\tvar checkConfirmPass = (rule, value, callback) => {\n\t\t\tif (value === '') {\n\t\t\t\treturn callback(new Error('确认密码不能为空'))\n\t\t\t} else if (this.form.alterPassword !== '') {\n\t\t\t\tif (value !== this.form.alterPassword) {\n\t\t\t\t\treturn callback(new Error('两次密码不一致'))\n\t\t\t\t}\n\t\t\t}\n\t\t\tcallback()\n\t\t}\n\n\n\t\treturn {\n\t\t\tform: {\n\t\t\t\toriginalPassword: '',\n\t\t\t\talterPassword: '',\n\t\t\t\tconfirmPassword: ''\n\t\t\t},\n\t\t\t// 表单验证，需要在 el-form-item 元素中增加 prop 属性\n\t\t\trules: {\n\t\t\t\toriginalPassword: [{\n\t\t\t\t\trequired: true,\n\t\t\t\t\tvalidator: checkPassword,\n\t\t\t\t\ttrigger: 'blur'\n\t\t\t\t}],\n\t\t\t\talterPassword: [{\n\t\t\t\t\trequired: true,\n\t\t\t\t\tvalidator: checkalterPass,\n\t\t\t\t\ttrigger: 'blur'\n\t\t\t\t}],\n\t\t\t\tconfirmPassword: [{\n\t\t\t\t\trequired: true,\n\t\t\t\t\tvalidator: checkConfirmPass,\n\t\t\t\t\ttrigger: 'blur'\n\t\t\t\t}]\n\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tonSubmit(form) {\n\n\t\t\t// 为表单绑定验证功能\n\t\t\tthis.$refs[form].validate((valid) => {\n\n\t\t\t\t// 当用户，没有按照规则填写登录信息，就会是false\n\t\t\t\tif (valid) {\n\n\t\t\t\t\tthis.$confirm('此操作将修改密码, 是否继续?', '提示', {\n\t\t\t\t\t\tconfirmButtonText: '确定',\n\t\t\t\t\t\tcancelButtonText: '取消',\n\t\t\t\t\t\ttype: 'warning'\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 开始登录验证\n\t\t\t\t\t\tlet that = this\n\t\t\t\t\t\taxios.put(\"http://localhost:8080/api/studentInfos/updateByPrimaryKeyChangePassword\", {\n\t\t\t\t\t\t\tstudent_id: JSON.parse(this.$store.state.token).student_id,\n\t\t\t\t\t\t\tpasswordBefore: this.form.originalPassword,\n\t\t\t\t\t\t\tpassword: this.form.alterPassword\n\t\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t\tMessage.success(\"更新密码成功\")\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar flag = JSON.parse(that.$store.state.token)\n\t\t\t\t\t\t\tflag.password = that.form.alterPassword\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tthat.$store.commit('$_setToken', JSON.stringify(flag));\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t// console.log(JSON.parse(that.$store.state.token))\n\t\t\t\t\t\t\tthat.form.originalPassword = ''\n\t\t\t\t\t\t\tthat.form.alterPassword = ''\n\t\t\t\t\t\t\tthat.form.confirmPassword = ''\n\t\t\t\t\t\t\n\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\tMessage.error(\"原密码错误\")\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t}).catch(() => {\n\t\t\t\t\t\tthis.$message({\n\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\tmessage: '已取消修改密码'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t});\n\t\t}\n\t}\n}\n",{"version":3,"sources":["alterPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"alterPassword.vue","sourceRoot":"src/views/student/alter","sourcesContent":["<template>\r\n\t<div style=\"margin-top: 100px;margin-left: 50px;\">\r\n\t\t<el-form label-width=\"80px\" :model=\"form\" status-icon :rules=\"rules\" ref=\"alterPassword\">\r\n\t\t\t<el-form-item label=\"原密码\" prop=\"originalPassword\">\r\n\t\t\t\t<el-input v-model=\"form.originalPassword\" style=\"width: 200px;\" prefix-icon=\"el-icon-lock\" show-password\r\n\t\t\t\t\tplaceholder=\"请输入原密码\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"修改密码\" prop=\"alterPassword\">\r\n\t\t\t\t<el-input v-model=\"form.alterPassword\" style=\"width: 200px;\" prefix-icon=\"el-icon-lock\" show-password\r\n\t\t\t\t\tplaceholder=\"请输入修改之后密码\" @keyup.enter.native=\"onSubmit('alterPassword')\">\r\n\t\t\t\t</el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n\t\t\t\t<el-input v-model=\"form.confirmPassword\" style=\"width: 200px;\" prefix-icon=\"el-icon-lock\" show-password\r\n\t\t\t\t\tplaceholder=\"请确认修改之后密码\" @keyup.enter.native=\"onSubmit('alterPassword')\">\r\n\t\t\t\t</el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" round style=\"width: 100px;\" @click=\"onSubmit('alterPassword')\" :plain=\"true\">\r\n\t\t\t\t\t确认\r\n\t\t\t\t</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t</el-form>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport axios from 'axios';\r\n\timport {\r\n\t\tMessage\r\n\t} from 'element-ui';\r\n\texport default {\r\n\t\tname: 'AlterPassword',\r\n\t\tdata() {\r\n\r\n\t\t\tvar checkPassword = (rule, value, callback) => {\r\n\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\treturn callback(new Error('原密码不能为空'))\r\n\t\t\t\t} else if (value !== JSON.parse(this.$store.state.token).password) {\r\n\t\t\t\t\treturn callback(new Error('与原密码不一致'))\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar checkalterPass = (rule, value, callback) => {\r\n\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\treturn callback(new Error('修改密码不能为空'))\r\n\t\t\t\t} else if (this.form.confirmPassword !== '') {\r\n\t\t\t\t\tif (value !== this.form.confirmPassword) {\r\n\t\t\t\t\t\treturn callback(new Error('两次密码不一致'))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar checkConfirmPass = (rule, value, callback) => {\r\n\t\t\t\tif (value === '') {\r\n\t\t\t\t\treturn callback(new Error('确认密码不能为空'))\r\n\t\t\t\t} else if (this.form.alterPassword !== '') {\r\n\t\t\t\t\tif (value !== this.form.alterPassword) {\r\n\t\t\t\t\t\treturn callback(new Error('两次密码不一致'))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcallback()\r\n\t\t\t}\r\n\r\n\r\n\t\t\treturn {\r\n\t\t\t\tform: {\r\n\t\t\t\t\toriginalPassword: '',\r\n\t\t\t\t\talterPassword: '',\r\n\t\t\t\t\tconfirmPassword: ''\r\n\t\t\t\t},\r\n\t\t\t\t// 表单验证，需要在 el-form-item 元素中增加 prop 属性\r\n\t\t\t\trules: {\r\n\t\t\t\t\toriginalPassword: [{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tvalidator: checkPassword,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\talterPassword: [{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tvalidator: checkalterPass,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tconfirmPassword: [{\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tvalidator: checkConfirmPass,\r\n\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t}]\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonSubmit(form) {\r\n\r\n\t\t\t\t// 为表单绑定验证功能\r\n\t\t\t\tthis.$refs[form].validate((valid) => {\r\n\r\n\t\t\t\t\t// 当用户，没有按照规则填写登录信息，就会是false\r\n\t\t\t\t\tif (valid) {\r\n\r\n\t\t\t\t\t\tthis.$confirm('此操作将修改密码, 是否继续?', '提示', {\r\n\t\t\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// 开始登录验证\r\n\t\t\t\t\t\t\tlet that = this\r\n\t\t\t\t\t\t\taxios.put(\"http://localhost:8080/api/studentInfos/updateByPrimaryKeyChangePassword\", {\r\n\t\t\t\t\t\t\t\tstudent_id: JSON.parse(this.$store.state.token).student_id,\r\n\t\t\t\t\t\t\t\tpasswordBefore: this.form.originalPassword,\r\n\t\t\t\t\t\t\t\tpassword: this.form.alterPassword\r\n\t\t\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\t\t\tMessage.success(\"更新密码成功\")\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar flag = JSON.parse(that.$store.state.token)\r\n\t\t\t\t\t\t\t\tflag.password = that.form.alterPassword\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthat.$store.commit('$_setToken', JSON.stringify(flag));\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// console.log(JSON.parse(that.$store.state.token))\r\n\t\t\t\t\t\t\t\tthat.form.originalPassword = ''\r\n\t\t\t\t\t\t\t\tthat.form.alterPassword = ''\r\n\t\t\t\t\t\t\t\tthat.form.confirmPassword = ''\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}).catch(function(error) {\r\n\t\t\t\t\t\t\t\tMessage.error(\"原密码错误\")\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\tmessage: '已取消修改密码'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\n"]}]}